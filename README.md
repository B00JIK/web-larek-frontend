# Проектная работа "Веб-ларек"

Реализация интернет-магазина для веб-разработчиков. Он состоит из каталога товаров, которые можно добавить в корзину, а затем заказать, указав метод оплаты и личные данные.

## Об архитектуре 

Архитектура проекта разрабатывается с использованием паттерна MVP(Model-View-Presenter), в котором основными слоями являются M(Model) - это модели данных, V(View) - компоненты представления, отвечающие за отображение данных на экране и P(Presenter) - код презентера не будет выделен в отдельный класс, а будет содержаться в оснвном скрипте index.ts.
Взаимодействия внутри приложения происходят через события. Модели инициализируют события, слушатели событий в основном коде выполняют передачу данных компонентам отображения, а также вычислениями между этой передачей, и еще они меняют значения в моделях.
 

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

# Описание базовых классов

## Класс Api

Конструктор:

`constructor(baseUrl: string, options: RequestInit = {})`- принимает базовый URL и глобальные опции для всех запросов(опционально).
 
 Методы: 

- constructor(baseUrl: string, options: RequestInit = {})`- принимает базовый URL и глобальные опции для всех запросов(опционально).
- handleResponse(response: Response): Promise<object> - обработчик ответа сервера.
- get(uri: string) - принимает изменяющеюся часть url-адреса, возвращает ответ от сервера.
- post(uri: string, data: object, method: ApiPostMethods = 'POST') - принимает изменяющеюся часть url-адреса, принимает данные в виде объекта для отправки на сервер, type ApiPostMethods = 'POST' | 'PUT' | 'DELETE'.

## Класс EventEmitter - брокер событий.

Класс EventEmitter реализует паттерн «Observer/Наблюдатель» и обеспечивает работу событий, его методы позволяют устанавливать и снимать слушатели событий.

Методы:

- on - Установить обработчик на событие.
- off - Снять обработчик с события.
- emit - Инициировать событие с данными.
- onAll - Слушать все события.
- offAll - Сбросить все обработчики.
- trigger - Сделать коллбек триггер, генерирующий событие при вызове.

# Описание классов Model, которые позволяют хранить и обрабатывать данные с сервера и от пользователей.

## Класс ApiServer наследуется от класса Api, передаёт и получает данные от сервера.

Методы: 

- getItem - получаем данные товаров с сервера.
- postOrder - отправляем данные о заказе на сервер. 

## Класс BasketModel работает с данными товаров, добавленных в корзину.

`constructor(protected events: IEvents)` - принимает объект events для создания событий.

- сеттер - basketItemsList(value: IItemData[]) - заполняет массив данными товаров, находящихся в корзине.
- геттер - basketItemsList(): IItemData[] - возвращает массив с данными товаров, находящихся в корзине.

Методы:

- itemsCounter - считаем количество товаров в корзине.
- totalItemsPrice - считаем сумму денег за все товары в корзине.
- addItem - добавляем товары в корзину.
- deleteItem - добавляем товары в корзину.
- itemsIdList - собираем айди товаров, добавленных в корзину.
- clearBasket - удаляем все товары из корзины после оформления заказа.

## Класс DataModel работает с данными, полученными с сервера.

`constructor(protected events: IEvents)` - принимает объект events для создания событий.

Методы:

- setItems - создаем массив из данных, полученных с сервера, и отслеживаем изменения в данных.
- getItems - возвращаем массив данных.

## Класс FormModel работает с данными, полученными от пользователя

`constructor(protected events: IEvents)` - принимает объект events для создания событий.

Методы:

- setOrderAddress - сохраняем адрес пользователя.
- setOrderContatcs - сохраняем номер телефона и почту пользователя.
- validateAddress - проверяем, введен ли адрес и выбран ли способ оплаты.
- validateContacts - проверяем, введены ли телефон и почта.
- getOrder - возвращаем объект с данными пользователя и данными выбранного товара.

# Классы View позволяют отображать элементы на странице и взаимодействовать с пользователем.

## Класс Basket управляет отображением элементов в корзине.

`constructor(container: HTMLElement, protected events: IEvents)` - принимает контейнер корзины и объект events для создания событий.

- сеттер - itemList(items: HTMLElement[]) - добавляет в разметку массив с карточками товаров, добавленных в корзину, и отключает возможность нажать на кнопку, если корзина пуста.

Метод:

- totalItems - устанавливаем сумму всех товаров в корзине.
- renderBasket - выводим элемент корзины на экран.

## Класс BasketItem управляет отображением товаров в корзине.

`constructor(container: HTMLElement, protected events: IEvents)` - принимает контейнер карточки товара в корзине и объект events для создания событий.

- геттер - id() - возвращает айди товара.

Метод:

- renderItem - выводим карточку выбронного товара.

## Класс Form управляет отображением форм.

`constructor(container: HTMLFormElement)` - принимает контейнер формы.

- сеттер - valid(value: boolean) - делает кнопку неактивной, если какие-то поля формы не прошли валидацию.
- сеттер - errors(value: string) - устанавливает тект ошибки, если какие-то поля формы не прошли валидацию.

Метод: 

- render - выводит форму на экран.

## Класс ContactForm наследуется от класса Form и управляет отображением формы получения телефона и почты от пользователя.

`constructor(container: HTMLElement, protected events: IEvents)` - принимает контейнер формы для получения контактных данных и объект events для создания событий.

## Класс Item управляет отображением карточек товаров на странице.

`constructor(container: HTMLElement, protected events: IEvents)` - принимает контейнер карточки товара в гвлерее и объект events для создания событий.

- сеттер - title(value: string) - устанавливает имя товара.
- сеттер - category(value: string) - устанавливает категорию товара.
- сеттер - image(value: string) - устанавливает картинку товара.
- сеттер - price(value: number) - устанавливает цену товара.
- сеттер - id(value: string) - устанавливает айди товара.

## Класс Modal отвечает за открытие и закрытие модальных окон.

`constructor(container: HTMLElement, protected events: IEvents)` - принимает контейнер модального окна и объект events для создания событий.

- сеттер - content(value: HTMLElement) - устанавливает контент в контейнер модального окна.
- сеттер - locked(value: boolean) - блокирует прокрутку страницы при открытии модального окна и разблокирует при закрытии.

Методы:

- open - открываем модальное окно.
- close - закрываем модальное окно.
- render - заполняем модальное окно данными.

## Класс Page отвечает за отображение данных на главной странице.

`constructor(container: HTMLElement, protected events: IEvents)` - принимает контейнер страницы и объект events для создания событий.

- сеттер - itemList(items: HTMLElement[]) - добавляет карточки товаров в разметку страницы.

Метод:

- totalItems - устанавливаем, какое количество товаров находится в корзине.

## Класс PaymentForm насследуется от класса Form и управляет отображением формы получения адреса и метода оплаты.

`constructor(container: HTMLElement, protected events: IEvents)` - принимает контейнер формы выбора оплаты и адреса и объект events для создания событий.

- сеттер - choosePaymentMethod(paymentMethod: string) - делает кнопку выбранного метода оплаты активной.

## Класс PopupItem управляет отображением модального окна с подробным описанием товара, позволяет добавить товар в корзину.

`constructor(container: HTMLElement, protected events: IEvents)` - принимает контейнер модального окна с подробным описанием товара и объект events для создания событий.

- сеттер - title(value: string) - устанавливает имя товара.
- сеттер - category(value: string) - устанавливает категорию товара.
- сеттер - image(value: string) - устанавливает картинку товара.
- сеттер - price(value: number) - устанавливает цену товара.
- сеттер - buttonDisabled(value: boolean) - октлючает возможность нажать кнопку.
- сеттер - id(value: string) - устанавливает айди товара.

## Класс Success управляет отображением модального окна с информацией об удачном завершении покупки.

`constructor(container: HTMLElement, protected events: IEvents)` - принимает контейнер модального окна успешной покупки и объект events для создания событий.

Метод:

- render(total: number) - заполяем модальное окно данными о количестве списанных синапсов.

## Основные типы и интерфейсы

// Данные товара
interface IItemData {
    id: string; // айди товара.
    category: string; // категория товара.
    title: string; // имя товара.
    image: string; // картинка товара.
    price: number | null; // цена товара.
    description: string; // описание товара.
}

// Данные пользователя
interface IOrderForm {
    email?: string; // электронный адрес пользователя.
    phone?: string; // телефон пользователя.
    address?: string; // адрес пользователя.
    payment?: string; // предпочитаемый тип оплаты.
    total?: number; // общая сумма заказа.
}

// Массив данных товаров.
interface IDataModel {
    items: IItemData[];
}

// Массив данных товаров, выбранных пользователем
interface IOrder extends IOrderForm {
    items: string[]
}

//Купленные упленных товаров, отправляемых на сервер
interface IOrderResult {
    id: string[]; //айди товаров
    total: number; //общая сумма заказа.
}

//Ошибки форм
type FormErrors = Partial<Record<keyof IOrder, string>>;

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
